# –ê–Ω–∞–ª–∏–∑ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤

## –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è-–í—ã—Å–æ–∫–∞—è (70-80%)

–°–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –±–∞–∑–æ–≤—É—é –∑–∞—â–∏—Ç—É, –Ω–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å.

---

## ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

### 1. –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–•–æ—Ä–æ—à–æ –∑–∞—â–∏—â–µ–Ω–æ**

- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã PostgreSQL (`$1`, `$2`, etc.)
- –ó–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–∞—Å—Å–∏–≤ `values`, –∞ –Ω–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–µ–π —Å—Ç—Ä–æ–∫
- –ö–ª—é—á–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–æ–¥–∞:**
```typescript
values.push(paramKey, numValue);
whereParts.push(`(main_parameters->>$${keyIndex})::numeric >= $${valueIndex}`);
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–•–æ—Ä–æ—à–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ**

- Try-catch –±–ª–æ–∫ –≤ `SearchEngine.search()` (—Å—Ç—Ä–æ–∫–∏ 30-47)
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- –°–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç, –µ—Å–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ `min_value` –∏ `max_value` –∏–∑ —Å–ª–æ–≤–∞—Ä—è (—Å—Ç—Ä–æ–∫–∏ 49-62 –≤ `parameter-normalizer.service.ts`)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ `unresolved`

---

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∫–ª—é—á–µ–π —Å —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏ `_min`/`_max`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –≤ —Å–ª–æ–≤–∞—Ä–µ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Å –∫–ª—é—á–æ–º, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–º—Å—è –Ω–∞ `_min` –∏–ª–∏ `_max`, —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// –ü–∞—Ä–∞–º–µ—Ç—Ä –≤ —Å–ª–æ–≤–∞—Ä–µ: "max_power" (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å)
// LLM –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: { "max_power": "100" }
// –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –¥–∏–∞–ø–∞–∑–æ–Ω –≤–º–µ—Å—Ç–æ —Ç–æ—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript:82:97:src/normalization/query-parameter-normalizer.ts
for (const [key, value] of Object.entries(query.parameters)) {
  if (key.endsWith("_min")) {
    const baseKey = key.replace("_min", "");
    minParams[baseKey] = value;
  } else if (key.endsWith("_max")) {
    const baseKey = key.replace("_max", "");
    maxParams[baseKey] = value;
  } else {
    regularParams[key] = value;
  }
}
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π
**–†–µ—à–µ–Ω–∏–µ:** 
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é –ø—Ä–æ–≤–µ—Ä–∫—É: `key.endsWith("_min") && key !== "_min"`
- –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤ —Å–ª–æ–≤–∞—Ä–µ –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º

### 2. –ù–µ—Ç–æ—á–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞ —á–∏—Å–µ–ª

**–ü—Ä–æ–±–ª–µ–º–∞:** `parseFloat()` –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–º–µ—Ä—ã:**
```typescript
parseFloat("100 –ª.—Å.")  // ‚Üí 100 ‚úÖ
parseFloat("abc")       // ‚Üí NaN ‚úÖ (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è)
parseFloat("100.5.5")   // ‚Üí 100.5 ‚ö†Ô∏è (—á–∞—Å—Ç–∏—á–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è)
parseFloat("")          // ‚Üí NaN ‚úÖ
parseFloat("  ")        // ‚Üí NaN ‚úÖ
parseFloat("1e10")      // ‚Üí 10000000000 ‚ö†Ô∏è (–Ω–∞—É—á–Ω–∞—è –Ω–æ—Ç–∞—Ü–∏—è)
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript:186:187:src/normalization/query-parameter-normalizer.ts
const numValue = typeof value === "string" ? parseFloat(value) : Number(value);
if (!Number.isNaN(numValue)) {
```

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π-–°—Ä–µ–¥–Ω–∏–π
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é:
```typescript
function strictParseNumber(value: string | number): number | null {
  if (typeof value === "number") {
    return Number.isFinite(value) ? value : null;
  }
  const trimmed = String(value).trim();
  if (!trimmed || !/^-?\d+(\.\d+)?$/.test(trimmed)) {
    return null;
  }
  const parsed = parseFloat(trimmed);
  return Number.isFinite(parsed) ? parsed : null;
}
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –∏ null –∑–Ω–∞—á–µ–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ –≤–∞–ª–∏–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// LLM –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: { "–ú–æ—â–Ω–æ—Å—Ç—å": "" }
// –¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è (rawValue == null –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç)
// –ù–æ –µ—Å–ª–∏ —ç—Ç–æ enum: "" –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ –≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript:30:32:src/normalization/parameter-normalizer.service.ts
for (const [rawKey, rawValue] of Object.entries(rawParams)) {
  // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º null/undefined
  if (rawValue == null) continue;
```

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫:
```typescript
if (rawValue == null || (typeof rawValue === "string" && rawValue.trim() === "")) {
  continue;
}
```

### 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ª–æ–≤–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω.

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript:32:33:src/search/search.engine.ts
// –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–æ–≤–∞—Ä—å, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
await this.dictionaryService!.loadDictionary();
```

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ `dictionaryLoaded` –≤ `ParameterDictionaryService`)
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ - —Å–ª–æ–≤–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –±–ª–∞–≥–æ–¥–∞—Ä—è —Ñ–ª–∞–≥—É `dictionaryLoaded`

### 5. –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// –°–ª–æ–≤–∞—Ä—å: { key: "power_hp", param_type: "number" }
// LLM: { "–ú–æ—â–Ω–æ—Å—Ç—å": "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ" }
// –†–µ–∑—É–ª—å—Ç–∞—Ç: normalized["power_hp"] = null (–∏–ª–∏ undefined)
// –í SQL: –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript:75:76:src/normalization/parameter-normalizer.service.ts
if (normalizedValue != null) {
  normalized[paramDef.key] = normalizedValue;
```

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–ø—Ä–æ–≤–µ—Ä–∫–∞ `!= null` –µ—Å—Ç—å)
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –£–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è - –∑–Ω–∞—á–µ–Ω–∏—è —Å `null` –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `normalized`

### 6. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω–æ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–æ–≥—É—Ç —Ç–µ—Ä—è—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∏–ª–∏ –±—ã—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// 1 —Ç–æ–Ω–Ω–∞ = 1000 –∫–≥
// –ù–æ —á—Ç–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –≥—Ä–∞–º–º—ã?
// 1 —Ç–æ–Ω–Ω–∞ = 1,000,000 –≥—Ä–∞–º–º
// –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: t ‚Üí g: 1000000 ‚úÖ
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript:69:100:src/normalization/unit-parser.ts
private convertUnit(value: number, from: string, to: string): number {
  if (from === to) return value;
  
  const conversions: Record<string, Record<string, number>> = {
    // –ú–∞—Å—Å–∞
    t: { kg: 1000, g: 1000000 },
    // ...
  };
  
  if (conversions[from]?.[to]) {
    return value * conversions[from][to];
  }
  
  // –ï—Å–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
  return value; // ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
}
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π
**–†–µ—à–µ–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞—Ç—å `null` –∏–ª–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞:
```typescript
if (conversions[from]?.[to]) {
  return value * conversions[from][to];
}
// –ï—Å–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º null
return null;
```

### 7. –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞—Å—Å–∏–≤–æ–≤ –≤ SQL

**–ü—Ä–æ–±–ª–µ–º–∞:** PostgreSQL –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ (–æ–±—ã—á–Ω–æ 32767).

**–†–∏—Å–∫:** –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ –∏–º–µ—Ç—å —Å—Ç–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É:
```typescript
if (values.length > 30000) {
  throw new Error("–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ");
}
```

### 8. Enum –º–∞–ø–ø–∏–Ω–≥ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –ª–∏–±–µ—Ä–∞–ª—å–Ω—ã–º

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ enum –º–∞–ø–ø–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `includes()`, —á—Ç–æ –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// –°–ª–æ–≤–∞—Ä—å: { "diesel": "–¥–∏–∑–µ–ª—å" }
// LLM: "–Ω–µ–¥–∏–∑–µ–ª—å–Ω—ã–π" 
// –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω —Å "diesel" –∏–∑-–∑–∞ includes("–¥–∏–∑–µ–ª—å")
```

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript:22:30:src/normalization/enum-mapper.ts
for (const [canonical, label] of Object.entries(paramDef.enum_values)) {
  const normalizedLabel = label.toLowerCase();
  if (
    normalizedLabel === normalized ||
    normalized.includes(normalizedLabel) ||  // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
    normalizedLabel.includes(normalized)
  ) {
    return canonical;
  }
}
```

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π-–°—Ä–µ–¥–Ω–∏–π
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:
```typescript
// –°–Ω–∞—á–∞–ª–∞ —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
if (normalizedLabel === normalized) {
  return canonical;
}
// –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–ª–∏–Ω–∞ –ø–æ—Ö–æ–∂–∞
if (Math.abs(normalizedLabel.length - normalized.length) <= 2) {
  if (normalizedLabel.includes(normalized) || normalized.includes(normalizedLabel)) {
    return canonical;
  }
}
```

---

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç LLM

**–ü—Ä–æ–±–ª–µ–º–∞:** LLM –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è.

**–ü—Ä–∏–º–µ—Ä—ã:**
```typescript
// LLM –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å:
{
  parameters: {
    "–ú–æ—â–Ω–æ—Å—Ç—å": null,           // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
    "–í–µ—Å": undefined,            // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
    "–¢–∏–ø": 12345,                // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞
    "–í–µ—Å_max": "abc",            // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è (NaN)
    "–í–µ—Å_min": Infinity,         // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É
    "–í–µ—Å_max": -Infinity,        // ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É
  }
}
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é:
```typescript
function validateParameterValue(value: any): boolean {
  if (value == null) return false;
  if (typeof value === "number") {
    return Number.isFinite(value); // –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç Infinity –∏ NaN
  }
  if (typeof value === "string") {
    return value.trim().length > 0;
  }
  return true;
}
```

### 2. –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—É–¥–∞—á–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–π –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –Ω–æ –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π)
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫:
```typescript
// –í SearchEngine
if (result.stats.unresolved > 0) {
  // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
  logger.warn("Unresolved parameters", {
    unresolved: result.stats.unresolved,
    total: result.stats.total,
    confidence: result.stats.confidence
  });
}
```

---

## üìä –ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤

| –ü—Ä–æ–±–ª–µ–º–∞ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ç–∞—Ç—É—Å |
|----------|-------------|---------|-----------|--------|
| –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∫–ª—é—á–µ–π —Å —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏ | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –°—Ä–µ–¥–Ω–∏–π | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è |
| –ù–µ—Ç–æ—á–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞ —á–∏—Å–µ–ª | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–æ–µ | –ù–∏–∑–∫–∏–π | ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ |
| –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–æ–µ | –ù–∏–∑–∫–∏–π | ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ–≤–∞—Ä—è | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–æ–µ | –ù–∏–∑–∫–∏–π | ‚úÖ –†–µ—à–µ–Ω–æ |
| –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –°—Ä–µ–¥–Ω–∏–π | ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ |
| –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –°—Ä–µ–¥–Ω–∏–π | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è |
| –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ SQL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –ù–∏–∑–∫–∏–π | ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ |
| Enum –º–∞–ø–ø–∏–Ω–≥ | –ù–∏–∑–∫–∞—è-–°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –°—Ä–µ–¥–Ω–∏–π | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è |
| –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –°—Ä–µ–¥–Ω–∏–π | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–æ–µ | –ù–∏–∑–∫–∏–π | ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ |

---

## üõ°Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ)

1. **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   ```typescript
   function validateSearchQuery(query: SearchQuery): boolean {
     if (!query.parameters) return true;
     
     for (const [key, value] of Object.entries(query.parameters)) {
       if (typeof value === "number" && !Number.isFinite(value)) {
         return false;
       }
       if (typeof value === "string" && value.trim().length === 0) {
         return false;
       }
     }
     return true;
   }
   ```

2. **–£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –µ–¥–∏–Ω–∏—Ü**
   - –í–æ–∑–≤—Ä–∞—â–∞—Ç—å `null` –≤–º–µ—Å—Ç–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è—Ö

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ)

3. **–£–ª—É—á—à–∏—Ç—å enum –º–∞–ø–ø–∏–Ω–≥**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ > —á–∞—Å—Ç–∏—á–Ω–æ–µ)

4. **–î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∫–ª—é—á–µ–π**
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞ –≤ —Å–ª–æ–≤–∞—Ä–µ –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ —Å—É—Ñ—Ñ–∏–∫—Å–∞–º

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ)

5. **–£–ª—É—á—à–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ —á–∏—Å–µ–ª**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤–º–µ—Å—Ç–æ `parseFloat()`

6. **–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –°–æ–±–∏—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–µ—É–¥–∞—á–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–π
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–ª—É—á–∞–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–û–±—â–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** 70-80%

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
- ‚ö†Ô∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases
- ‚ö†Ô∏è –£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–Ω–µ–¥—Ä–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –∏–∑ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ 1 –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º.






