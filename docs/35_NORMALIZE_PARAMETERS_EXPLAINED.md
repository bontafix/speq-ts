# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ normalize-parameters.ts

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

`normalize-parameters.ts` **–Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è** –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `equipment`:
- –ß–∏—Ç–∞–µ—Ç `main_parameters` (—Å—ã—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö)
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Ö –≤ `normalized_parameters` (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –ë–î

## üéØ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

–í –ë–î –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö:
- **–†–∞–∑–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è:** "–ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è", "–º–æ—â–Ω–æ—Å—Ç—å", "power", "–ú–æ—â–Ω–æ—Å—Ç—å, –∫–í—Ç"
- **–†–∞–∑–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã:** "132 –ª.—Å.", "97 –∫–í—Ç", "97kW", "132hp"
- **–†–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è enum:** "–î–∏–∑–µ–ª—å", "–¥–∏–∑–µ–ª—å–Ω—ã–π", "diesel", "–î–∏–∑–µ–ª—å–Ω–æ–µ —Ç–æ–ø–ª–∏–≤–æ"

–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –≤—Å—ë –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É:
- **–ï–¥–∏–Ω—ã–µ –∫–ª—é—á–∏:** `engine_power_kw`
- **–ï–¥–∏–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã:** –≤—Å–µ–≥–¥–∞ –∫–∏–ª–æ–≤–∞—Ç—Ç—ã (–∫–í—Ç)
- **–ï–¥–∏–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:** `"diesel"` –≤–º–µ—Å—Ç–æ —Ä–∞–∑–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

```typescript
const dictionaryService = new ParameterDictionaryService();
await dictionaryService.loadDictionary();
```

–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ `parameter_dictionary` –∏–∑ –ë–î, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏ (`engine_power_kw`, `operating_weight_t`)
- –ê–ª–∏–∞—Å—ã (–≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π)
- –¢–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (number/enum/boolean/string)
- –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
- Enum –∑–Ω–∞—á–µ–Ω–∏—è

### –®–∞–≥ 2: –ü–æ–∏—Å–∫ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

```typescript
const records = await findRecordsToNormalize(mode, limit);
```

**–†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã:**

1. **`missing` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)** - —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ –±–µ–∑ `normalized_parameters`:
   ```sql
   WHERE normalized_parameters IS NULL 
      OR normalized_parameters = '{}'::jsonb
   ```

2. **`merge`** - –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏:
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - –ù–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ

3. **`force`** - –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å:
   - –£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ —Å –Ω—É–ª—è

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (`is_active = true`)
- –¢–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ —Å –Ω–µ–ø—É—Å—Ç—ã–º–∏ `main_parameters`
- –ú–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ—Ä–µ–∑ `NORMALIZE_BATCH_SIZE`

### –®–∞–≥ 3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

–î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:

```typescript
const result = normalizer.normalize(record.main_parameters);
```

**–ü—Ä–æ—Ü–µ—Å—Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:**

#### 3.1. –ü–æ–∏—Å–∫ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –∫–ª—é—á–∞

```typescript
const paramDef = dictionaryService.findCanonicalKey(rawKey);
```

–ò—â–µ—Ç –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ –∞–ª–∏–∞—Å–∞–º:
- `"–ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è"` ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç `engine_power_kw`
- `"–º–æ—â–Ω–æ—Å—Ç—å"` ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç `engine_power_kw`
- `"power"` ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç `engine_power_kw`
- `"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä"` ‚Üí –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç ‚Üí –ø–æ–ø–∞–¥–∞–µ—Ç –≤ `unresolved`

#### 3.2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É

**–î–ª—è `number` (—á–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã):**

```typescript
normalizedValue = unitParser.parseValue(rawValue, paramDef.unit);
```

–ü—Ä–∏–º–µ—Ä—ã:
- `"132 –ª.—Å."` + unit: `"kw"` ‚Üí `97.152` (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ª.—Å. –≤ –∫–í—Ç)
- `"25 —Ç"` + unit: `"t"` ‚Üí `25` (—É–∂–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö)
- `"25000 –∫–≥"` + unit: `"t"` ‚Üí `25` (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∫–≥ –≤ —Ç–æ–Ω–Ω—ã)

**–î–ª—è `enum` (–ø–µ—Ä–µ—á–∏—Å–ª—è–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è):**

```typescript
normalizedValue = enumMapper.mapEnumValue(String(rawValue), paramDef);
```

–ü—Ä–∏–º–µ—Ä—ã:
- `"–î–∏–∑–µ–ª—å"` ‚Üí `"diesel"`
- `"–¥–∏–∑–µ–ª—å–Ω—ã–π"` ‚Üí `"diesel"`
- `"–î–∏–∑–µ–ª—å–Ω–æ–µ —Ç–æ–ø–ª–∏–≤–æ"` ‚Üí `"diesel"`

**–î–ª—è `boolean` (–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è):**

```typescript
// "–¥–∞", "true", "1", "yes" ‚Üí true
// "–Ω–µ—Ç", "false", "0", "no" ‚Üí false
```

**–î–ª—è `string` (—Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è):**

```typescript
// –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ –æ–±—Ä–µ–∑–∞–µ—Ç –ø—Ä–æ–±–µ–ª—ã
"  –ö–∞–±–∏–Ω–∞  " ‚Üí "–ö–∞–±–∏–Ω–∞"
```

#### 3.3. –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

```typescript
{
  normalized: {
    "engine_power_kw": 97.152,
    "operating_weight_t": 25,
    "fuel_type": "diesel"
  },
  unresolved: {
    "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä": "–∫–∞–∫–æ–µ-—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ"
  },
  confidence: 0.75  // 75% –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ
}
```

### –®–∞–≥ 4: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î

```typescript
await saveNormalizedParameters(record.id, normalizedToSave);
```

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç `normalized_parameters` –≤ —Ç–∞–±–ª–∏—Ü—É `equipment`:
- –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª–µ `normalized_parameters`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `normalized_at = NOW()`

## üìä –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (`main_parameters`):

```json
{
  "–ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è": "132 –ª.—Å.",
  "–í–µ—Å –≤ —Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏": "25 —Ç",
  "–¢–∏–ø —Ç–æ–ø–ª–∏–≤–∞": "–î–∏–∑–µ–ª—å",
  "–ì–ª—É–±–∏–Ω–∞ –∫–æ–ø–∞–Ω–∏—è": "6500 –º–º",
  "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä": "–∫–∞–∫–æ–µ-—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ"
}
```

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (`normalized_parameters`):

```json
{
  "engine_power_kw": 97.152,
  "operating_weight_t": 25,
  "fuel_type": "diesel",
  "excavation_depth_mm": 6500
}
```

**–ù–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (–Ω–µ –ø–æ–ø–∞–ª–∏ –≤ `normalized_parameters`):
- `"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä"` - –Ω–µ—Ç –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ä–µ–∂–∏–º—ã

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –†–µ–∂–∏–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (missing/merge/force)
NORMALIZE_MODE=missing

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫
NORMALIZE_BATCH_SIZE=100

# –í–∫–ª—é—á–∏—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
DEBUG=true
```

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã:

**1. `missing` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
```bash
NORMALIZE_MODE=missing npx tsx src/scripts/normalize-parameters.ts
```
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ –±–µ–∑ `normalized_parameters`
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º, –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

**2. `merge`:**
```bash
NORMALIZE_MODE=merge npx tsx src/scripts/normalize-parameters.ts
```
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–æ–≤—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏
- –ü–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –æ–±–Ω–æ–≤–∏–ª—Å—è –∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**3. `force`:**
```bash
NORMALIZE_MODE=force npx tsx src/scripts/normalize-parameters.ts
```
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ! –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞—Ç—á–∞–º–∏:

```bash
# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ 100 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑
NORMALIZE_BATCH_SIZE=100 npx tsx src/scripts/normalize-parameters.ts
```

–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è:
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä–∫–µ
- –ò–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –ë–î

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç:

```
–†–ï–ó–£–õ–¨–¢–ê–¢–´
================================================================================
–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞–ø–∏—Å–µ–π: 844
–£—Å–ø–µ—à–Ω–æ: 844
–û—à–∏–±–æ–∫: 0
–í—Å–µ–≥–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 5234
–í—Å–µ–≥–æ –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 1234
–°—Ä–µ–¥–Ω–∏–π confidence: 80.9%
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- **–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞–ø–∏—Å–µ–π** - —Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –∏–∑ –ë–î –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
- **–£—Å–ø–µ—à–Ω–æ/–û—à–∏–±–æ–∫** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç–æ–∫
- **–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - —Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É—Å–ø–µ—à–Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ù–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - —Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–µ –Ω–∞—à–ª–æ—Å—å –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ
- **–°—Ä–µ–¥–Ω–∏–π confidence** - –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```sql
SELECT 
  id,
  name,
  main_parameters,
  normalized_parameters
FROM equipment
WHERE normalized_parameters IS NOT NULL
  AND normalized_parameters != '{}'::jsonb
LIMIT 10;
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø–∏—Å–∏ –±–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:

```sql
SELECT COUNT(*)
FROM equipment
WHERE is_active = true
  AND main_parameters IS NOT NULL
  AND main_parameters != '{}'::jsonb
  AND (normalized_parameters IS NULL OR normalized_parameters = '{}'::jsonb);
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:

```bash
npx tsx src/scripts/analyze-unresolved-parameters.ts
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
   - –ï—Å–ª–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—É—Å—Ç, —Å–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞: `npx tsx src/scripts/seed-parameter-dictionary-complete.ts`

2. **–ù–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è
   - –û–Ω–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ `main_parameters`
   - –ü—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ `normalized_parameters`
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ–∑–∂–µ

3. **–†–µ–∂–∏–º `force` –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!
   - –õ—É—á—à–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä–∫–µ

4. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–¥—ë—Ç –ø–æ –±–∞—Ç—á–∞–º**
   - –ï—Å–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `NORMALIZE_BATCH_SIZE`
   - –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–æ –ø–æ–ª–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üîÑ –¢–∏–ø–∏—á–Ω—ã–π workflow

1. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫:**
   ```bash
   npx tsx src/scripts/seed-parameter-dictionary-complete.ts
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ:**
   ```bash
   npx tsx src/scripts/analyze-unresolved-parameters.ts
   ```

3. **–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
   ```bash
   npx tsx src/scripts/normalize-parameters.ts
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
   ```sql
   SELECT COUNT(*) FROM equipment 
   WHERE normalized_parameters IS NOT NULL;
   ```

5. **–ï—Å–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–µ–ø–æ–∫—Ä—ã—Ç—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
   - –î–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ (–≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ LLM)
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Å–Ω–æ–≤–∞

## üéØ –ò—Ç–æ–≥

`normalize-parameters.ts` - —ç—Ç–æ **–º–æ—Å—Ç –º–µ–∂–¥—É —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º**:
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ (–±–∞—Ç—á–∞–º–∏)
