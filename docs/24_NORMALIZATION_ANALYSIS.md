# –ê–Ω–∞–ª–∏–∑ –ø–∞–ø–∫–∏ `normalization` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (30.12.2025)

## üìö –û–±–∑–æ—Ä

–ü–∞–ø–∫–∞ `/src/normalization` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–æ—â–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î. –≠—Ç–æ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞—è** —á–∞—Å—Ç—å –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∫–æ–Ω–≤–µ—Ä—Å–∏—é –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è (`"5 –º–µ—Ç—Ä–æ–≤"` ‚Üí `5000 –º–º`)
- ‚úÖ –ú–∞–ø–ø–∏–Ω–≥ –∞–ª–∏–∞—Å–æ–≤ (`"–º–æ—â–Ω–æ—Å—Ç—å"` ‚Üí `"engine_power_kw"`)
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é enum –∑–Ω–∞—á–µ–Ω–∏–π (`"–¥–∏–∑–µ–ª—å"` ‚Üí `"diesel"`)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç—É –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π

---

## üì¶ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. `index.ts` - –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞

```typescript
export { ParameterDictionaryService } from "./parameter-dictionary.service";
export { ParameterNormalizerService } from "./parameter-normalizer.service";
export { QueryParameterNormalizer } from "./query-parameter-normalizer";
export { UnitParser } from "./unit-parser";
export { EnumMapper } from "./enum-mapper";
```

**–ß—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç:**
- –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞: `import { UnitParser } from "../normalization"`

---

### 2. `parameter-dictionary.service.ts` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –ë–î (`parameter_dictionary`)

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
class ParameterDictionaryService {
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏–∑ –ë–î
  async loadDictionary(): Promise<void>
  
  // –ü–æ–ª—É—á–∏—Ç—å –≤–µ—Å—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫
  getDictionary(): ParameterDefinition[]
  
  // –ù–∞–π—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ canonical key
  getByKey(canonicalKey: string): ParameterDefinition | undefined
  
  // –ù–∞–π—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ –∞–ª–∏–∞—Å—É (—Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π!)
  findCanonicalKey(alias: string): ParameterDefinition | undefined
}
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `ParameterDefinition`:**

```typescript
interface ParameterDefinition {
  key: string;              // "engine_power_kw"
  label_ru: string;         // "–ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è"
  description_ru: string;   // –û–ø–∏—Å–∞–Ω–∏–µ
  category: string;         // "excavator", "crane", "common"
  param_type: string;       // "number", "enum", "boolean"
  unit?: string;            // "kw", "t", "mm"
  min_value?: number;       // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  max_value?: number;       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  enum_values?: Record<string, string>;
  aliases: string[];        // ["–º–æ—â–Ω–æ—Å—Ç—å", "power", ...]
  sql_expression: string;   // "main_parameters->>'–ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è'"
  priority: number;         // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∏ –ø–æ–∏—Å–∫–µ
}
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```typescript
const dictService = new ParameterDictionaryService();
await dictService.loadDictionary();

// –ü–æ–∏—Å–∫ –ø–æ –∞–ª–∏–∞—Å—É
const param = dictService.findCanonicalKey("–º–æ—â–Ω–æ—Å—Ç—å");
// ‚Üí { key: "engine_power_kw", unit: "kw", ... }

// –ü–æ–∏—Å–∫ –ø–æ canonical key
const param = dictService.getByKey("engine_power_kw");
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
- ‚úÖ –ü—Ä–∏ –º–∞–ø–ø–∏–Ω–≥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç LLM –∫ –ë–î
- ‚úÖ –ü—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

### 3. `unit-parser.ts` - –ü–∞—Ä—Å–∏–Ω–≥ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –µ–¥–∏–Ω–∏—Ü

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫–∏ —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –µ–¥–∏–Ω–∏—Ü—ã:**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ï–¥–∏–Ω–∏—Ü—ã | Canonical |
|-----------|---------|-----------|
| **–ú–∞—Å—Å–∞** | —Ç, —Ç–æ–Ω–Ω, –∫–≥, –≥ | kg |
| **–ú–æ—â–Ω–æ—Å—Ç—å** | –ª.—Å., –∫–í—Ç, –í—Ç | kw |
| **–î–ª–∏–Ω–∞** | –∫–º, –º, —Å–º, –º–º | mm |
| **–û–±—ä–µ–º** | –º¬≥, –ª | m3 |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | —Ç/—á, –º¬≥/—á | t/h, m3/h |
| **–ß–∞—Å—Ç–æ—Ç–∞** | –ì—Ü, –æ–±/–º–∏–Ω | hz, rpm |

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
class UnitParser {
  // –ü–∞—Ä—Å–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ —Ü–µ–ª–µ–≤—É—é –µ–¥–∏–Ω–∏—Ü—É
  parseValue(rawValue: string | number, targetUnit: string): number | null
  
  // –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –µ–¥–∏–Ω–∏—Ü—É –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏–∑ —Å—Ç—Ä–æ–∫–∏
  detectUnit(rawValue: string | number): string | null
  
  // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –º–µ–∂–¥—É –µ–¥–∏–Ω–∏—Ü–∞–º–∏
  convertUnit(value: number, fromUnit: string, toUnit: string): number
}
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```typescript
const parser = new UnitParser();

// –ü–∞—Ä—Å–∏–Ω–≥ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Å–∏–µ–π
parser.parseValue("132 –ª.—Å.", "kw");     // ‚Üí 97.152 (–∫–í—Ç)
parser.parseValue("25 —Ç–æ–Ω–Ω", "kg");      // ‚Üí 25000 (–∫–≥)
parser.parseValue("5 –º–µ—Ç—Ä–æ–≤", "mm");     // ‚Üí 5000 (–º–º)
parser.parseValue("1,5 –º¬≥", "m3");       // ‚Üí 1.5 (–º¬≥)

// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü—ã
parser.detectUnit("132 –ª.—Å.");           // ‚Üí "hp"
parser.detectUnit("25 —Ç–æ–Ω–Ω");            // ‚Üí "t"
parser.detectUnit("5000");               // ‚Üí null

// –ü—Ä—è–º–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è
parser.convertUnit(132, "hp", "kw");     // ‚Üí 97.152
parser.convertUnit(5, "m", "mm");        // ‚Üí 5000
parser.convertUnit(25, "t", "kg");       // ‚Üí 25000
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç LLM (–æ–Ω–∏ —á–∞—Å—Ç–æ –≤–∫–ª—é—á–∞—é—Ç –µ–¥–∏–Ω–∏—Ü—ã)
- ‚úÖ –ü—Ä–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –ø–æ–∏—Å–∫–æ–º –≤ –ë–î
- ‚úÖ –ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—è—Ç—ã–µ –∏ —Ç–æ—á–∫–∏ (1,5 –∏–ª–∏ 1.5)
- üîÑ –£—Å—Ç–æ–π—á–∏–≤ –∫ –ø—Ä–æ–±–µ–ª–∞–º ("132 –ª. —Å." = "132–ª.—Å.")
- üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è (—Ç, —Ç–æ–Ω–Ω, —Ç–æ–Ω–Ω–∞)
- ‚ùå –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `null` –µ—Å–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞

---

### 4. `enum-mapper.ts` - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è enum –∑–Ω–∞—á–µ–Ω–∏–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è enum –∑–Ω–∞—á–µ–Ω–∏–π –≤ canonical —Ñ–æ—Ä–º—É

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
class EnumMapper {
  // –ú–∞–ø–ø–∏—Ç raw –∑–Ω–∞—á–µ–Ω–∏–µ –≤ canonical —Ñ–æ—Ä–º—É
  mapEnum(paramKey: string, rawValue: string): string
}
```

**–ü—Ä–∏–º–µ—Ä—ã –º–∞–ø–ø–∏–Ω–≥–∞:**

```typescript
const mapper = new EnumMapper();

// –¢–∏–ø —Ç–æ–ø–ª–∏–≤–∞
mapper.mapEnum("fuel_type", "–¥–∏–∑–µ–ª—å");     // ‚Üí "diesel"
mapper.mapEnum("fuel_type", "–±–µ–Ω–∑–∏–Ω");     // ‚Üí "gasoline"
mapper.mapEnum("fuel_type", "—ç–ª–µ–∫—Ç—Ä–æ");    // ‚Üí "electric"

// –ü—Ä–∏–≤–æ–¥
mapper.mapEnum("drive_type", "–≥—É—Å–µ–Ω–∏—á–Ω—ã–π"); // ‚Üí "tracked"
mapper.mapEnum("drive_type", "–∫–æ–ª–µ—Å–Ω—ã–π");   // ‚Üí "wheeled"

// –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞–∫ –µ—Å—Ç—å
mapper.mapEnum("unknown", "value");        // ‚Üí "value"
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (excavator, crane, etc)
- ‚úÖ –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ç–∏–ø–æ–≤ —Ç–æ–ø–ª–∏–≤–∞, –ø—Ä–∏–≤–æ–¥–∞
- ‚úÖ –ü—Ä–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

---

### 5. `parameter-normalizer.service.ts` - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä (–∑–Ω–∞—á–µ–Ω–∏–µ + –µ–¥–∏–Ω–∏—Ü–∞)

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
class ParameterNormalizerService {
  // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑ —Å–ª–æ–≤–∞—Ä—è
  normalize(
    paramDef: ParameterDefinition,
    rawValue: string | number
  ): { key: string; value: number | string } | null
}
```

**–õ–æ–≥–∏–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:**

```typescript
// 1. –ï—Å–ª–∏ number + unit ‚Üí –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ UnitParser
paramDef = { key: "power_kw", param_type: "number", unit: "kw" }
rawValue = "132 –ª.—Å."
‚Üí { key: "power_kw", value: 97.152 }

// 2. –ï—Å–ª–∏ enum ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —á–µ—Ä–µ–∑ EnumMapper
paramDef = { key: "fuel_type", param_type: "enum" }
rawValue = "–¥–∏–∑–µ–ª—å"
‚Üí { key: "fuel_type", value: "diesel" }

// 3. –ï—Å–ª–∏ boolean ‚Üí –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ boolean
paramDef = { key: "has_blade", param_type: "boolean" }
rawValue = "–¥–∞"
‚Üí { key: "has_blade", value: true }

// 4. –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–æ—à–ª–æ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç null
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –í–Ω—É—Ç—Ä–∏ `QueryParameterNormalizer` (—Å–º. –Ω–∏–∂–µ)
- ‚úÖ –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è SearchQuery (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `QueryParameterNormalizer`)

---

### 6. `query-parameter-normalizer.ts` - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ–≥–æ SearchQuery

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –í–°–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `SearchQuery` –∑–∞ –æ–¥–∏–Ω –≤—ã–∑–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
class QueryParameterNormalizer {
  // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ SearchQuery
  normalize(query: SearchQuery): SearchQuery
}
```

**–ü—Ä–æ—Ü–µ—Å—Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:**

```typescript
// –ò—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å –æ—Ç LLM
const query: SearchQuery = {
  text: "—ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä",
  parameters: {
    "–º–æ—â–Ω–æ—Å—Ç—å_min": "100 –ª.—Å.",
    "–≤–µ—Å_max": "25 —Ç–æ–Ω–Ω",
    "–≥–ª—É–±–∏–Ω–∞_–∫–æ–ø–∞–Ω–∏—è": "5 –º–µ—Ç—Ä–æ–≤"
  }
};

const normalizer = new QueryParameterNormalizer(dictionaryService);
const normalized = normalizer.normalize(query);

// –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
{
  text: "—ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä",
  parameters: {
    "engine_power_kw_min": 73.6,      // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ
    "operating_weight_t_max": 25,     // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ
    "excavation_depth_mm": 5000       // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ
  }
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—É—Ñ—Ñ–∏–∫—Å–æ–≤ `_min` / `_max`:**

```typescript
// –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
{
  "–≥–ª—É–±–∏–Ω–∞_–∫–æ–ø–∞–Ω–∏—è_min": "3000",  // –°—É—Ñ—Ñ–∏–∫—Å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ
  "–≤–µ—Å_max": "50"                 // –°—É—Ñ—Ñ–∏–∫—Å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ
}

// –ü–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
{
  "excavation_depth_mm_min": 3000,  // –°—É—Ñ—Ñ–∏–∫—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω
  "operating_weight_t_max": 50      // –°—É—Ñ—Ñ–∏–∫—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –í `SearchEngine.search()` –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–∞ –∫ –ë–î
- ‚úÖ –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–µ—Å—å `SearchQuery` —Ü–µ–ª–∏–∫–æ–º
- ‚úÖ –≠—Ç–æ **–ì–õ–ê–í–ù–´–ô** entry point –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

---

### 7. `parameter-name-mapper.ts` - Fallback –º–∞–ø–ø–µ—Ä (legacy)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Fallback –º–∞–ø–ø–∏–Ω–≥ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ë–î

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:**
–≠—Ç–æ **–ù–ï** –æ—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏!  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞:
1. –°–ª–æ–≤–∞—Ä—å –∏–∑ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
2. –ü–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ª–æ–≤–∞—Ä–µ
3. –ù—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –º–∞–ø–ø–∏–Ω–≥ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –ë–î

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
class ParameterNameMapper {
  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –æ—Ç LLM –∫ –∏–º–µ–Ω–∏ –≤ –ë–î
  static mapParameterName(llmParamName: string): {
    dbParamName: string;
    suffix?: '_min' | '_max';
    originalName: string;
  }
  
  // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ (–±–∞–∑–æ–≤–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è)
  static convertValue(dbParamName: string, value: number): number
  
  // –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –µ–¥–∏–Ω–∏—Ü–∞—Ö
  static getUnitInfo(dbParamName: string): { fromUnit: string; toUnit: string } | null
}
```

**–ü—Ä–∏–º–µ—Ä:**

```typescript
// –ú–∞–ø–ø–∏–Ω–≥ –∏–º–µ–Ω–∏
const mapped = ParameterNameMapper.mapParameterName("–≥–ª—É–±–∏–Ω–∞_–∫–æ–ø–∞–Ω–∏—è_max");
// ‚Üí { dbParamName: "–ú–∞–∫—Å. –≥–ª—É–±–∏–Ω–∞ –∫–æ–ø–∞–Ω–∏—è, –º–º.", suffix: "_max" }

// –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∑–Ω–∞—á–µ–Ω–∏—è
const converted = ParameterNameMapper.convertValue("–ú–∞–∫—Å. –≥–ª—É–±–∏–Ω–∞ –∫–æ–ø–∞–Ω–∏—è, –º–º.", 5);
// ‚Üí 5000 (5 –º–µ—Ç—Ä–æ–≤ ‚Üí 5000 –º–º)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ö–∞–∫ fallback –≤ `EquipmentRepository.normalizeParameter()`
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω `ParameterDictionaryService`

---

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è SearchQuery –≤ SearchEngine

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```typescript
// src/search/search.engine.ts

class SearchEngine {
  private queryNormalizer?: QueryParameterNormalizer;

  constructor(
    private readonly equipmentRepository: EquipmentRepository,
    private readonly dictionaryService?: ParameterDictionaryService,
    private readonly llmFactory?: LLMProviderFactory
  ) {
    if (this.dictionaryService) {
      this.queryNormalizer = new QueryParameterNormalizer(this.dictionaryService);
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
      this.dictionaryService.loadDictionary().catch(error => {
        console.error("[SearchEngine] Failed to load dictionary:", error);
      });
    }
  }

  async search(query: SearchQuery, limit: number = 10): Promise<SearchResult> {
    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–∞–ø—Ä–æ—Å
    const normalizedQuery = this.queryNormalizer
      ? this.queryNormalizer.normalize(query)
      : query;

    // ... –¥–∞–ª–µ–µ –≤—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ —Å normalizedQuery
  }
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `SearchEngine` —Å–æ–∑–¥–∞–µ—Ç—Å—è `QueryParameterNormalizer`
2. –°–ª–æ–≤–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
3. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ `search()` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `queryNormalizer`
4. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∏–¥–µ—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ Repository

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```typescript
// src/repository/equipment.repository.ts

class EquipmentRepository {
  private dictionaryService?: ParameterDictionaryService;
  private unitParser: UnitParser;

  constructor(dictionaryService?: ParameterDictionaryService) {
    this.dictionaryService = dictionaryService;
    this.unitParser = new UnitParser();
  }

  private normalizeParameter(
    key: string,
    value: string | number
  ): {
    paramKey: string;
    value: number | string;
    operator: '=' | '>=' | '<=';
    sqlCast: string;
  } | null {
    // 1. –ü–†–ò–û–†–ò–¢–ï–¢: –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ —Å–ª–æ–≤–∞—Ä—å –∏–∑ –ë–î
    if (this.dictionaryService) {
      const paramDef = this.dictionaryService.findCanonicalKey(key);
      if (paramDef) {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º canonical key + UnitParser
        const parsed = this.unitParser.parseValue(value, paramDef.unit);
        return { paramKey, value: parsed, operator, sqlCast };
      }
    }
    
    // 2. FALLBACK: ParameterNameMapper
    const mapped = ParameterNameMapper.mapParameterName(key);
    return { /* ... */ };
  }

  async fullTextSearch(query: SearchQuery): Promise<EquipmentSummary[]> {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if (query.parameters) {
      for (const [key, value] of Object.entries(query.parameters)) {
        const normalized = this.normalizeParameter(key, value);
        // ... –∏—Å–ø–æ–ª—å–∑—É–µ–º normalized –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è SQL
      }
    }
  }
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. Repository –ø–æ–ª—É—á–∞–µ—Ç `dictionaryService` —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
2. –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
   - –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç –Ω–∞–π—Ç–∏ –≤ —Å–ª–æ–≤–∞—Ä–µ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí fallback –Ω–∞ `ParameterNameMapper`
3. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ `UnitParser`
4. –°—Ç—Ä–æ–∏—Ç SQL —É—Å–ª–æ–≤–∏—è —Å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Standalone –ø–∞—Ä—Å–∏–Ω–≥ –µ–¥–∏–Ω–∏—Ü

**–ü—Ä–∏–º–µ—Ä:**

```typescript
import { UnitParser } from "../normalization";

const parser = new UnitParser();

// –í UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
function formatParameter(rawValue: string, targetUnit: string) {
  const parsed = parser.parseValue(rawValue, targetUnit);
  if (parsed !== null) {
    return `${parsed} ${targetUnit}`;
  }
  return rawValue;
}

// –í –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º
function validatePowerInput(input: string): boolean {
  const parsed = parser.parseValue(input, "kw");
  return parsed !== null && parsed >= 10 && parsed <= 1000;
}
```

---

## üìä –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∑–∞–ø—Ä–æ—Å                                   ‚îÇ
‚îÇ    "–≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä —Å –º–æ—â–Ω–æ—Å—Ç—å—é 132 –ª.—Å. –∏ –≤–µ—Å–æ–º –¥–æ 25 —Ç–æ–Ω–Ω"         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SearchQuery                                   ‚îÇ
‚îÇ    {                                                             ‚îÇ
‚îÇ      "text": "—ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä",                                       ‚îÇ
‚îÇ      "parameters": {                                             ‚îÇ
‚îÇ        "–º–æ—â–Ω–æ—Å—Ç—å": "132 –ª.—Å.",                                   ‚îÇ
‚îÇ        "–≤–µ—Å_max": "25 —Ç–æ–Ω–Ω"                                      ‚îÇ
‚îÇ      }                                                           ‚îÇ
‚îÇ    }                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. SearchEngine.search() ‚Üí QueryParameterNormalizer.normalize() ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ    ‚îÇ ParameterDictionaryService.findCanonicalKey()         ‚îÇ   ‚îÇ
‚îÇ    ‚îÇ   "–º–æ—â–Ω–æ—Å—Ç—å" ‚Üí { key: "engine_power_kw", unit: "kw" } ‚îÇ   ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                           ‚îÇ                                      ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ    ‚îÇ UnitParser.parseValue("132 –ª.—Å.", "kw")               ‚îÇ   ‚îÇ
‚îÇ    ‚îÇ   ‚Üí 97.152                                             ‚îÇ   ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ    –†–µ–∑—É–ª—å—Ç–∞—Ç:                                                    ‚îÇ
‚îÇ    {                                                             ‚îÇ
‚îÇ      "text": "—ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä",                                       ‚îÇ
‚îÇ      "parameters": {                                             ‚îÇ
‚îÇ        "engine_power_kw": 97.152,                                ‚îÇ
‚îÇ        "operating_weight_t_max": 25                              ‚îÇ
‚îÇ      }                                                           ‚îÇ
‚îÇ    }                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. EquipmentRepository.fullTextSearch(normalizedQuery)          ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ    –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ SQL:                                               ‚îÇ
‚îÇ    WHERE (main_parameters->>'–ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è')::numeric      ‚îÇ
‚îÇ            >= 97.152                                             ‚îÇ
‚îÇ      AND (main_parameters->>'–í–µ—Å –≤ —Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏')::numeric ‚îÇ
‚îÇ            <= 25                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5. PostgreSQL –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üéì Best Practices

### 1. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ QueryParameterNormalizer

```typescript
// ‚ùå –ü–ª–æ—Ö–æ - –æ–±—Ö–æ–¥–∏–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é
const results = await repository.fullTextSearch(rawQuery);

// ‚úÖ –•–æ—Ä–æ—à–æ - –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–µ—Ä–µ–¥ –ø–æ–∏—Å–∫–æ–º
const normalized = queryNormalizer.normalize(rawQuery);
const results = await repository.fullTextSearch(normalized);
```

### 2. –ó–∞–≥—Ä—É–∂–∞–π—Ç–µ —Å–ª–æ–≤–∞—Ä—å –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ - –∑–∞–≥—Ä—É–∂–∞–µ–º –≤ AppContainer.init()
async init() {
  try {
    await this.dictionaryService.loadDictionary();
  } catch (e) {
    console.warn("Dictionary load failed");
  }
}

// ‚ùå –ü–ª–æ—Ö–æ - –∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
async search(query) {
  await this.dictionaryService.loadDictionary(); // –ú–µ–¥–ª–µ–Ω–Ω–æ!
  // ...
}
```

### 3. Graceful degradation

```typescript
// ‚úÖ –•–æ—Ä–æ—à–æ - fallback –µ—Å–ª–∏ —Å–ª–æ–≤–∞—Ä—å –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω
const normalized = this.queryNormalizer
  ? this.queryNormalizer.normalize(query)
  : query;

// ‚úÖ –•–æ—Ä–æ—à–æ - fallback –≤ normalizeParameter
if (this.dictionaryService) {
  // –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ —Å–ª–æ–≤–∞—Ä—å
} else {
  // Fallback –Ω–∞ ParameterNameMapper
}
```

### 4. –õ–æ–≥–∏—Ä—É–π—Ç–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é

```typescript
if (process.env.DEBUG) {
  console.log(`[Normalizer] ${key} ‚Üí ${paramKey} = ${normalizedValue}`);
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```bash
# –¢–µ—Å—Ç –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
npx tsx src/scripts/test-normalization-integration.ts
```

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä—è –∏–∑ –ë–î
- ‚úÖ Fallback –º–∞–ø–ø–∏–Ω–≥
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Å–∏—è –µ–¥–∏–Ω–∏—Ü
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –∞–ª–∏–∞—Å–∞–º
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã min/max
- ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

---

## ‚ú® –ò—Ç–æ–≥

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `normalization` –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç:**

1. **–ì–∏–±–∫–æ—Å—Ç—å** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ –ë–î, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
2. **–¢–æ—á–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è –µ–¥–∏–Ω–∏—Ü
3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

**–ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞:**
- `QueryParameterNormalizer` - –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ–≥–æ SearchQuery
- `UnitParser` - –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –µ–¥–∏–Ω–∏—Ü
- `ParameterDictionaryService` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º
- `ParameterNameMapper` - –¥–ª—è fallback –º–∞–ø–ø–∏–Ω–≥–∞

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

