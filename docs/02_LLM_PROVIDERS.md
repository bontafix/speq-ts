# LLM –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≥–∏–±–∫–æ—Å—Ç–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              QuestionParser / Worker                     ‚îÇ
‚îÇ                         ‚Üì                                ‚îÇ
‚îÇ              LLMProviderFactory                          ‚îÇ
‚îÇ                         ‚Üì                                ‚îÇ
‚îÇ     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ     ‚Üì          ‚Üì              ‚Üì              ‚îÇ          ‚îÇ
‚îÇ  Ollama     Groq          OpenAI             ‚îÇ          ‚îÇ
‚îÇ (–ª–æ–∫–∞–ª—å–Ω–æ) (–æ–±–ª–∞–∫–æ)      (–æ–±–ª–∞–∫–æ)           ‚îÇ          ‚îÇ
‚îÇ                                              ‚îÇ          ‚îÇ
‚îÇ              –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Fallback ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### 1. Ollama (–ª–æ–∫–∞–ª—å–Ω—ã–π)

**–ü–ª—é—Å—ã:**
- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏
- –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ embeddings

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç –º–æ—â–Ω–æ–µ –∂–µ–ª–µ–∑–æ (CPU/GPU)
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –æ–±–ª–∞—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- –ù—É–∂–Ω–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –º–æ–¥–µ–ª—è–º–∏

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```env
LLM_CHAT_PROVIDER=ollama
LLM_EMBEDDINGS_PROVIDER=ollama
OLLAMA_BASE_URL=http://127.0.0.1:11434
LLM_MODEL=qwen2.5:7b-instruct-q4_K_M
EMBED_MODEL=nomic-embed-text
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
# https://ollama.ai
ollama pull qwen2.5:7b-instruct-q4_K_M
ollama pull nomic-embed-text
```

### 2. Groq (–æ–±–ª–∞—á–Ω—ã–π)

**–ü–ª—é—Å—ã:**
- ‚ö° –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä—ã–π (LPU —á–∏–ø—ã)
- –ü–æ—á—Ç–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier
- –ù–µ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –≤–∞—à–µ –∂–µ–ª–µ–∑–æ
- –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- –î–∞–Ω–Ω—ã–µ —É—Ö–æ–¥—è—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä—ã
- –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç embeddings

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```env
LLM_CHAT_PROVIDER=groq
GROQ_API_KEY=gsk_xxxxxxxxxxxxx
LLM_MODEL=llama-3.3-70b-versatile
GROQ_BASE_URL=https://api.groq.com

# –î–ª—è embeddings –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ollama
LLM_EMBEDDINGS_PROVIDER=ollama
EMBED_MODEL=nomic-embed-text
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞:**
https://console.groq.com

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏:**
- `llama-3.3-70b-versatile` ‚Äî –ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞
- `mixtral-8x22b-instruct` ‚Äî —Ö–æ—Ä–æ—à –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

### 3. OpenAI (–æ–±–ª–∞—á–Ω—ã–π)

**–ü–ª—é—Å—ã:**
- üèÜ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ embeddings
- –°—Ç–∞–±–∏–ª—å–Ω—ã–π API

**–ú–∏–Ω—É—Å—ã:**
- üí∞ –î–æ—Ä–æ–∂–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
- –¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- –î–∞–Ω–Ω—ã–µ —É—Ö–æ–¥—è—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä—ã

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```env
LLM_CHAT_PROVIDER=openai
OPENAI_API_KEY=sk-xxxxxxxxxxxxx
LLM_MODEL=gpt-4o-mini

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: embeddings —á–µ—Ä–µ–∑ OpenAI
LLM_EMBEDDINGS_PROVIDER=openai
EMBED_MODEL=text-embedding-3-small
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞:**
https://platform.openai.com/api-keys

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏:**
- Chat: `gpt-4o-mini` (–±—ã—Å—Ç—Ä–æ –∏ –¥–µ—à–µ–≤–æ) –∏–ª–∏ `gpt-4o` (–º–∞–∫—Å–∏–º—É–º –∫–∞—á–µ—Å—Ç–≤–∞)
- Embeddings: `text-embedding-3-small` (–¥–µ—à–µ–≤–æ) –∏–ª–∏ `text-embedding-3-large` (–∫–∞—á–µ—Å—Ç–≤–æ)

## Fallback –º–µ—Ö–∞–Ω–∏–∑–º

–ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ fallback:

```env
LLM_CHAT_PROVIDER=groq
LLM_FALLBACK_PROVIDERS=ollama,openai
```

–ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `groq`
2. –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí `ollama`
3. –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí `openai`
4. –ï—Å–ª–∏ –≤—Å–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã ‚Üí –æ—à–∏–±–∫–∞

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ)

```env
LLM_CHAT_PROVIDER=ollama
LLM_EMBEDDINGS_PROVIDER=ollama
LLM_MODEL=qwen2.5:7b-instruct-q4_K_M
EMBED_MODEL=nomic-embed-text
```

### Production (–±—ã—Å—Ç—Ä–æ, –¥–µ—à–µ–≤–æ)

```env
LLM_CHAT_PROVIDER=groq
GROQ_API_KEY=your_key
LLM_MODEL=llama-3.3-70b-versatile

LLM_EMBEDDINGS_PROVIDER=ollama
EMBED_MODEL=nomic-embed-text

LLM_FALLBACK_PROVIDERS=ollama
```

### Enterprise (–º–∞–∫—Å–∏–º—É–º –∫–∞—á–µ—Å—Ç–≤–∞)

```env
LLM_CHAT_PROVIDER=openai
OPENAI_API_KEY=your_key
LLM_MODEL=gpt-4o

LLM_EMBEDDINGS_PROVIDER=openai
EMBED_MODEL=text-embedding-3-large

LLM_FALLBACK_PROVIDERS=groq,ollama
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

```typescript
import { LLMProviderFactory, QuestionParser } from "./llm";

// –°–æ–∑–¥–∞–µ–º —Ñ–∞–±—Ä–∏–∫—É (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–∏—Ç–∞–µ—Ç .env)
const llmFactory = new LLMProviderFactory();

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤ QuestionParser
const parser = new QuestionParser(llmFactory);
const query = await parser.parse("–ù—É–∂–µ–Ω —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä");

// –ò–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä
const factory = new LLMProviderFactory({
  chatProvider: "groq",
  embeddingsProvider: "ollama",
  fallbackProviders: ["ollama"],
});

// –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º
const response = await factory.chat({
  model: "llama-3.3-70b-versatile",
  messages: [
    { role: "system", content: "You are a helpful assistant" },
    { role: "user", content: "Hello!" },
  ],
});

// Health check –≤—Å–µ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
const health = await factory.checkHealth();
console.log(health); // { ollama: true, groq: false, openai: true }
```

## –°—Ç–æ–∏–º–æ—Å—Ç—å (–ø—Ä–∏–º–µ—Ä–Ω–∞—è, –Ω–∞ —è–Ω–≤–∞—Ä—å 2025)

### –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | Chat (–ø–∞—Ä—Å–∏–Ω–≥) | Embeddings (10k –ø–æ–∑–∏—Ü–∏–π) |
|-----------|----------------|--------------------------|
| Ollama    | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ      | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ                |
| Groq      | ~$0.0001       | –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è        |
| OpenAI    | ~$0.0005       | ~$0.13                   |

### –ü—Ä–∏ 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –°—Ç–æ–∏–º–æ—Å—Ç—å/–º–µ—Å—è—Ü |
|-----------|-----------------|
| Ollama    | $0              |
| Groq + Ollama | ~$1 |
| OpenAI    | ~$5-50          |

**–í—ã–≤–æ–¥:** Groq + Ollama ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤.

